import { requireRole } from '../utils/rbac.js'; export default defineEventHandler(async(e)=>{ requireRole(e,'EDITOR'); const cfg=useRuntimeConfig(); const root=cfg.mediaRoot+'/uploads/images'; const q=getQuery(e); const rel=String(q.path||'').replace(/(^\/+|\.\.)/g,''); const fs=await import('node:fs/promises'); const p=(await import('node:path')).default.posix.join(root, rel); await fs.rm(p,{recursive:true,force:true}); return {ok:true} })
