import { requireRole } from '../../utils/rbac.js'; export default defineEventHandler(async(e)=>{ requireRole(e,'EDITOR'); const b=await readBody(e); const cfg=useRuntimeConfig(); const root=cfg.mediaRoot+'/uploads/videos'; const rel=String(b?.path||'').replace(/(^\/+|\.\.)/g,''); const name=String(b?.name||'').replace(/\//g,''); const fs=await import('node:fs/promises'); const p=(await import('node:path')).default.posix.join(root, rel, name); await fs.mkdir(p,{recursive:true}); return {ok:true} })
