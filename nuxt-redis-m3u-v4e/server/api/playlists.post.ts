import { requireRole } from '../utils/rbac.js'; import { r, nextId } from '../utils/redis.js'; export default defineEventHandler(async(e)=>{ requireRole(e,'EDITOR'); const b=await readBody(e); const id=await nextId('playlist'); const pl={id, name:b?.name||('Playlist '+id), channels:[]}; await r().set('playlist:'+id, JSON.stringify(pl)); await r().sadd('org:1:playlists', String(id)); return pl })
