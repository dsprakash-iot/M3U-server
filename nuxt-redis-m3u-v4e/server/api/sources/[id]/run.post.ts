import { requireRole } from '../../../utils/rbac.js'; import { r } from '../../../utils/redis.js'; export default defineEventHandler(async(e)=>{ requireRole(e,'EDITOR'); const id=e.context.params.id; const raw=await r().get('source:'+id); if(!raw) throw createError({status:404}); const s=JSON.parse(raw); s.nextAt=Date.now(); await r().set('source:'+id, JSON.stringify(s)); return {ok:true} })
